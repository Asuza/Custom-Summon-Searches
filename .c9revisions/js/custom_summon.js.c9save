{"ts":1341353217679,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"// Custom Summon Boxes\n\t// Grand Valley State University Library Labs, 2011, 2012\n\t// by Matthew Reidsma, reidsmam@gvsu.edu with help from John Krull, astrom.flux@gmail.com\n\t// \n\t// Released under Creative Commons Attribution 3.0 Unported License\n\t// http://creativecommons.org/licenses/by/3.0/\n\t//\n\n$(function() {\n\t\n\tfunction selectText(element) {\n\t    var text = document.getElementById(element);    \n\n\t    if (document.body.createTextRange) { // ms\n\t        var range = document.body.createTextRange();\n\t        range.moveToElementText(text);\n\t        range.select();\n\t    } else if (window.getSelection) { // moz, opera, webkit\n\t        var selection = window.getSelection();            \n\t        var range = document.createRange();\n\t        range.selectNodeContents(text);\n\t        selection.removeAllRanges();\n\t        selection.addRange(range);\n\t    }\n\t}\n\t\n\n\t// Handle the checkboxes\n\n\t$(\":checkbox\").click(function() {\n\n\t\tvar data = this.value.split(\"|\");\n\t\tvar textInput = 'input type=\"hidden\" name=\"' + data[0] + '\" value=\\'' + data[1] + data[2] + '\\' /';\n\n\t\tif ($(this).attr('checked')) {\n\n\t\t\t$(\"#search-refinements\").append('&lt;' + textInput + '&gt;<br/>');\n\n\t\t} else { // Unchecked\n\n\t\t\tvar value = $(\"#search-refinements\").text();\n\t\t\tvalue = value.replace('<' + textInput + '>', \"\");\n\t\t\tvalue = value.replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n\t\t\tvalue = value.replace(/&gt;/g,\"&gt;<br />\");\n\t\t\t$(\"#search-refinements\").html(value);\n\t\t\t\n\t\t}\n\n\t});\n\t\n\t\n\t// Date filter\n\t$(\"#start_year, #end_year\").keyup(refreshDateRange);\n\t$(\"#start_month, #start_day, #end_month, #end_day\").change(refreshDateRange);\n\t\n\tfunction refreshDateRange() {\n\n\t\tvar start_year = $(\"#start_year\").val();\n\t\tvar end_year   = $(\"#end_year\").val();\n\t\t\n\t\tif(end_year.length > 3) {\n\t\t\n\t\t\tvar start_range = '*';\n\t\t\tvar start_month = parseInt($(\"#start_month\").val()) || '';\n\t\t\tvar start_day   = parseInt($(\"#start_day\").val()) || '';\n\t\t\tvar end_month   = parseInt($(\"#end_month\").val()) || '';\n\t\t\tvar end_day     = parseInt($(\"#end_day\").val()) || '';\n\n\t\t\tif(start_month > 0) { start_month = '-' + (start_month.length < 2 ? \"0\" + start_month : start_month); } // Pad with zeros \n\t\t\tif(start_day > 0)   { start_day = '-' + (start_day.length < 2 ? \"0\" + start_day : start_day);         } // Pad with zeros\n\t\t\tif(start_year > 0)  { start_range = start_year + start_month + start_day; }\n\t\t\n\t\t\tif(end_month > 0) { end_month = '-' + (end_month.length < 2 ? \"0\" + end_month : end_month);           } // Pad with zeros\n\t\t\tif(end_day > 0)   {\tend_day = '-' + (end_day.length < 2 ? \"0\" + end_day : end_day);                   } // Pad with zeros\n\n\t\t\tend_range = end_year + end_month + end_day;\n\t\t\t\n\t\t\t$(\"#insert-pubdate\").html('&lt;input type=\"hidden\" name=\"s.rf\" value=\"PublicationDate,' + start_range + ':' + end_range + '\" /&gt;<br />');\n\t\t\t$(\"#search-refinements\").html( $(\"#search-refinements\").html() ); // Bug fix for Chrome\n\t\t}\n\n\t}\n\t\n\t$(\"#keywords\").keyup(function() {\n\t\tvar subject_terms = '&lt;input type=\"hidden\" name=\"s.fvgf[]\" value=\"SubjectTerms,or,' + this.value + '\" /&gt;<br />';\n\t\t$(\"#insertterms\").html(this.value ? subject_terms : '');\n\t});\n\t\n\t$(\".accordian-body\").hide();\n\t\n\t$(\".accordian-head\").find(\"h2\").prepend(\"<span>&#9656;</span>\");\n\t\n\t$(\".accordian-head\").click(function() {\n\t\tvar arrow = $(this).find(\"h2 span\").html();\n\t\t$(this).next(\".accordian-body\").slideToggle(400);\n\t\tif(arrow == \"<span>â–¾</span>\") {\n\t\t\t$(this).find(\"h2 span\").html(\"<span>&#9656;</span>\");\n\t\t} else {\n\t\t\t$(this).find(\"h2 span\").html(\"<span>&#9662;</span>\");\n\t\t}\n\t});\n\t\n\t$(\"#codeblock\").prepend('<div class=\"copybutton lib-button-small-grey\">Select All</div>');\n\t\n\t$(\".copybutton\").click(function(){\n\t    selectText(\"summon-code\");\n\t  });\n\t\n\t$(\"#clear-dates-button\").click(function() {\n\t\t$(\"#insert-pubdate\").html(\"\");\n\t\t$(\".dates\").val(\"\");\n\t\t$(\"select option:selected\").removeAttr(\"selected\");\n\t});\n});"]],"start1":0,"start2":0,"length1":0,"length2":3878}]],"length":3878}
{"contributors":[],"silentsave":false,"ts":1341353669429,"patch":[[{"diffs":[[0,"ment) {\n"],[-1,"\t"],[1,"    "],[0,"    var "]],"start1":341,"start2":341,"length1":17,"length2":20},{"diffs":[[0,"nt);"],[1,"\n"],[0,"    "],[-1,"\n\n\t"],[0,"    "],[-1,"if (document.body.createTextRange) { // ms\n\t        var range = "],[1,"var range = (document.createRange ? document.createRange() : document.body.createTextRange());\n\n        if ("],[0,"docu"]],"start1":397,"start2":397,"length1":83,"length2":125},{"diffs":[[0,"ateTextRange"],[-1,"();\n\t"],[1,") { // ms\n    "],[0,"        rang"]],"start1":535,"start2":535,"length1":29,"length2":38},{"diffs":[[0,"mentText(text);\n"],[-1,"\t"],[1,"    "],[0,"        range.se"]],"start1":584,"start2":584,"length1":33,"length2":36},{"diffs":[[0,"e.select();\n"],[-1,"\t"],[1,"    "],[0,"    } else i"]],"start1":616,"start2":616,"length1":25,"length2":28},{"diffs":[[0," webkit\n"],[-1,"\t"],[1,"    "],[0,"        "]],"start1":684,"start2":684,"length1":17,"length2":20},{"diffs":[[0,"n();"],[1,"\n"],[0,"    "],[-1,"        \n\t        var range = document.createRange();\n\t"],[0,"    "]],"start1":738,"start2":738,"length1":67,"length2":13},{"diffs":[[0,"(text);\n"],[-1,"\t"],[1,"   "],[0,"        "],[1," "],[0,"selectio"]],"start1":779,"start2":779,"length1":25,"length2":28},{"diffs":[[0,"nges();\n"],[-1,"\t"],[1,"    "],[0,"        "]],"start1":820,"start2":820,"length1":17,"length2":20},{"diffs":[[0,"range);\n"],[-1,"\t"],[1,"    "],[0,"    }\n\t}"]],"start1":859,"start2":859,"length1":17,"length2":20},{"diffs":[[0,"ckboxes\n"],[-1,"\n"],[0,"\t$(\":che"]],"start1":901,"start2":901,"length1":17,"length2":16}]],"length":3895,"saved":false}
